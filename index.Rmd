---
title: "Data Visualization in R"
subtitle: "è³‡æ–™è¦–è¦ºåŒ–å¿ƒæ³•èˆ‡æŠ€æ³•"
author:
    name: "Leo Lu"
    email: "leo0650@gmail.com"
    website: "https://github.com/leoluyi"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output:
    ioslides_presentation:
      css: css/style.css
      highlight: tango
      transition: faster
      widescreen: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = TRUE,
                      echo = TRUE,
                      message = FALSE,
                      collapse = FALSE,
                      comment = "#>",
                      fig.align='center',
                      cache=TRUE)
library(magrittr)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggrepel)  # text labeling
library(cowplot); theme_set(theme_grey()) 
library(ggplot2movies) # IMDB movie data
```

## How to use this slides

The following single character keyboard shortcuts enable alternate display modes:

- 'f' enable fullscreen mode
- 'w' toggle widescreen mode
- 'o' enable overview mode

### Download the slides

[Here](http://leoluyi.github.io/RViz_201609/)
(Right Click > Save As...)

##  

<div align="center" style="font-size: 200%">
<p>èª²ç¨‹è³‡è¨Š</p>
<a target="_blank" href="http://data-sci.info/">ç¶²ç«™</a>/
<a target="_blank" href="https://www.facebook.com/datasci.info">ç²‰çµ²é </a>/
<a target="_blank" href="https://github.com/datasci-info/TCA_R_Viz/issues">è«–å£‡</a>/
<a target="_blank" href="https://goo.gl/CX1yya">å»£æ’­</a>/
<a target="_blank" href="https://goo.gl/B3JFBu">å…±ç­†</a>
</div>

<div align="center">
<h3>
èª²å¾Œè‹¥æœ‰ä»»ä½•å•é¡Œæ­¡è¿è‡³è«–å£‡ç™¼å•
</h3>
</div>


## å¤§å®¶çš„ä¸€äº›èª²å‰å•é¡Œ

- å°æ–¼ï¼ˆè³‡æ–™ï¼‰è¦–è¦ºåŒ–æƒ³å¾—å¤ªç°¡å–®æˆ–å¤ªé›£
- è¦ºå¾—è¦–è¦ºåŒ–éœ€è¦å¤©ç”Ÿçš„è¨­è¨ˆç¾æ„Ÿï¼Ÿ
- å¥½çš„è¦–è¦ºåŒ–æ˜¯ä¸æ˜¯ä¸»è§€çš„ï¼Ÿ
- æƒ³å¯¦åšè‡ªå·±çš„è¦–è¦ºåŒ–æµç¨‹ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•é–‹å±•ï¼Œè€æ˜¯åšåˆ°ä¸€åŠæ”¾æ£„
- ç”¨ Excel è¾›è‹¦åšå‡ºçš„åœ–è¡¨ï¼Œå»ç„¡æ³•åœ¨ä¸‹æ¬¡é‡è¤‡ä½¿ç”¨
- å°å…¥è¦–è¦ºåŒ–å·¥å…·ï¼Œå»è®Šæˆã€Œç´”è©¦è©¦ã€ï¼Œä¸€é»éƒ½ä¸å¯¦ç”¨ï¼Œé€ æˆå°å…¥çš„è»Ÿé«”ç„¡æ³•ç™¼æ®å…¶æ•ˆç”¨

## {.flexbox .vcenter .emphasized}

ç‚ºä»€éº¼éœ€è¦è¦–è¦ºåŒ–ï¼Ÿ

## é—œæ–¼è³‡æ–™è¦–è¦ºåŒ–

+ ç™¼ç¾æ•…äº‹
+ èªªæœ
  - å±•ç¤ºè³‡æ–™
  - å±•ç¤ºè³‡æ–™èƒŒå¾Œçš„æ•…äº‹
+ åšæ±ºç­–

## EDA Process (Exploratory Data Analysis) {.flexbox .vcenter}

<img src="img/eda-process.png" style="height:480px; max-width:100%;">

## To Communicate {.flexbox .vcenter}

<a href="http://r4ds.had.co.nz/communicate-intro.html" target="_blank">
<img src="http://r4ds.had.co.nz/diagrams/data-science-communicate.png"  style="height:400px; max-width:100%;">
</a>


## 1854 å¹´éœäº‚

John Snow ç¹ªè£½äº†è‹±åœ‹å€«æ•¦è˜‡æ´»å€çš„éœäº‚åœ°åœ–ï¼Œæ¯”å°ç™¼ç¾æŸä¸€æ°´äº•å’Œæ„ŸæŸ“è€…çš„å±…ä½åœ°é»ç›¸è¿‘ï¼Œçµ‚æ–¼å°‡æ±™æŸ“æºé–å®šåœ¨è©²æ°´äº•ï¼Œä¸€å‘¨ä¹‹å¾Œï¼Œå¸‚æ”¿åºœå°±å°äº†é€™å£æ°´äº•ï¼Œå¾Œä¾†ä¹Ÿè­‰æ˜éœäº‚æ˜¯ç”±æ±™æ°´å‚³æŸ“è€Œéä¸€èˆ¬èªå®šçš„ç©ºæ°£å‚³æŸ“ã€‚

<img src="img/john-snow-cholera.png" style="max-height:360px; max-width:100%;">

<div class="footer">
http://blog.rtwilson.com/john-snows-cholera-data-in-more-formats/
</div>

## æˆ‘å€‘æ²’æœ‰å¤ªå¤šå‰å¤§çš„ç›®æ¨™

- å ±å‘Šçµ¦è€é—†ã€åŒäº‹......
- è®“ç›¸é—œçš„äººåšæ±ºç­–

> "The simple graph has brought more information to the data analyst's mind than any other device." -- John Tukey


## {.flexbox .vcenter .emphasized}

è³‡æ–™è¦–è¦ºåŒ–ï¼Œé‡é»åœ¨ã€Œ<underline>è³‡æ–™</underline>ã€ 

## è³‡æ–™è¦–è¦ºåŒ–æ€è€ƒç¯„ä¾‹ï¼šAnscombe's Quartet

ç¶“å…¸è³‡æ–™é›†ï¼šAnscombe's Quartet

- 4 x-y datasets
- ç›¸åŒçš„å¹³å‡æ•¸å’Œè®Šç•°æ•¸ â”€â”€ <underline>å¾æ•¸å­—ä¸Šå®Œå…¨çœ‹ä¸å‡ºå·®ç•°</underline>
- ç”¨ç”šéº¼æ–¹å¼å¯ä»¥çœ‹åˆ°å·®ç•°ï¼Ÿ

```{r, echo=FALSE}
psych::describe(anscombe)
knitr::kable(anscombe)
```

## è³‡æ–™è¦–è¦ºåŒ–æ€è€ƒç¯„ä¾‹ï¼šAnscombe's Quartet

- åœ–è¡¨å¯çœ‹åˆ°åŸæœ¬çœ‹ä¸åˆ°çš„æ±è¥¿

```{r, echo=FALSE}
library(tidyr)
anscombe_df <- anscombe %>%
  tbl_df %>%
  gather() %>%
  extract(key, c("xy", "dataset"), "([xy])(\\d)") %>%
  group_by(dataset, xy) %>%
  mutate(row = 1:n()) %>%
  spread(key = xy, value = value)

ggplot(anscombe_df, aes(x = x, y = y)) +
  geom_point(color = "black") +
  facet_wrap(~ dataset, ncol = 2) +
  geom_smooth(formula = y ~ x,
              method = "lm", se = FALSE)
```


## è¦–è¦ºåŒ–ä¹‹æ‰€ä»¥æœƒè®“äººè¦ºå¾—å¾ˆé›£

æ˜¯å› ç‚ºæˆ‘å€‘æƒ³è¦å­¸æœƒå…‰è­œçš„æ¯ä¸€æ®µï¼Œä½†äº‹å¯¦ä¸Šåªè¦æ ¹æ“š<underline>ç›®çš„</underline>å»å­¸

<img src="img/viz-type.png" style="max-height:auto; max-width:100%;">

<div class="footer">
http://www.excelcharts.com/blog/infographics-data-visualization/
</div>

## Tukey

- Box Plot

<a href="https://en.wikipedia.org/wiki/Box_plot">
<img src="img/Classic-box-wisker.png" style="height:auto; max-width:100%;">
</a>

## Stephen Few

- Dashboard

<a href="https://www.perceptualedge.com/blog/?p=1374">
<img src="img/dashboard-competition-runner-up.png" style="height:auto; max-width:100%;">
</a>

## More Infographics and Design {.smaller}

- [THE 100 BEST INFOGRAPHICS OF THE LAST DECADE](https://www.visualnews.com/2016/04/18/100-best-infographics-last-decade/)

<div align="center">
<a href="http://gotemcoach.com/post/37341676540/kobes-30k-infographic-detailing-kobe-bryants">
<img src="img/kobe-infographic.jpg" style="height:480px; max-width:100%;">
</a>
</div>

## {.flexbox .vcenter .emphasized}

è¦é¸æ“‡ä»€éº¼å·¥å…·ä½œåœ–ï¼Ÿ

## è¦é¸æ“‡ä»€éº¼å·¥å…·ä½œåœ–

1. é€™å¼µåœ–å¤šé‡è¦ï¼Ÿ
2. å¯ä»¥èŠ±å¤šå°‘æ™‚é–“ï¼Ÿå€¼å¾—èŠ±é€™éº¼å¤šæ™‚é–“å—ï¼Ÿ
3. æœ‰å¿…è¦é€™è¦ç•«å—ï¼Ÿ
4. é€™æ¨£ç•«æƒ³è¦å‘ˆç¾ä»€éº¼ï¼Ÿ

## åœ–è¡¨ä¹Ÿæœ‰åˆ†å¥½å£

> - è©•æ–·çš„æ¨™æº–æ˜¯ä»€éº¼ï¼Ÿ
> - æ ¹æ“šä¸åŒçš„ç†è«–å¯ä»¥æ“·å–å‡ºä¸Šç™¾ç¨®åŸå‰‡
> - æ‰€ä»¥æˆ‘å€‘è¦æŒæ¡ä¸€äº›å¿ƒæ³•ï¼Œè®“æˆ‘å€‘é¸æ“‡åœ–è¡¨æ™‚æ›´ç°¡å–®ã€å°ˆæ³¨

## {.flexbox .vcenter .emphasized}

å¸Œæœ›ä¸Šå®Œèª²å¾Œ<br/>å¤§å®¶éƒ½èƒ½æŠŠé€™å€‹èƒ½åŠ›å¸¶å›å»


# ggplot2 in R èˆ‡ç¹ªåœ–å¿ƒæ³•

## ggplot2 ç°¡ä»‹

- [`ggplot2`](http://ggplot2.org) æ˜¯ä¸€å€‹å¾ˆå¼·å¤§çš„è³‡æ–™æ¢ç´¢åŠè¦–è¦ºåŒ–å·¥å…·ï¼Œ
æ˜¯è¨±å¤šæœ€æœ‰å½±éŸ¿åŠ›çš„ R å¥—ä»¶é–‹ç™¼è€… [Hadley Wickham](http://had.co.nz) æ‰€é–‹ç™¼
- æ‰€æœ‰ç¹ªåœ–å‡½æ•¸éƒ½æœ‰èƒŒå¾Œçš„è¦–è¦ºåŒ–é‚è¼¯ï¼ˆ[Grammar of Graphics](http://www.amazon.com/The-Grammar-Graphics-Statistics-Computing/dp/0387245448)ï¼‰

__Grammar of Graphics__ çš„ä½œç”¨å°±æ˜¯å¹«åŠ©æˆ‘å€‘å°‡åœ–è¡¨æ‹†è§£æˆ<underline>å€‹åˆ¥å…ƒç´ </underline>ï¼Œ
ç„¶å¾Œå°‡é€™äº›å…ƒç´ æŒ‰ç…§é‚è¼¯å€‹åˆ¥æ“ä½œï¼Œ<underline>***æ­£ç¢º***åˆ***ç°¡å–®***</underline>åœ°é”åˆ°åœ–è¡¨çš„ç›®çš„

## {.flexbox .vcenter}

It is far better to learn a language by actually speaking it!

## ä¸€å€‹ä¾‹å­å­¸æœƒç•«åœ–ï¼šmpg ğŸš—æ²¹è€—è³‡æ–™

`mpg` dataset:  
Fuel economy data from 1999 and 2008 for 38 popular models of car.

| variable     | detail                                               |
|--------------|------------------------------------------------------|
| manufacturer | è»Šå»                                                  |
| model        | å‹è™Ÿ                                                 |
| displ        | å¼•æ“æ’æ°£é‡                                           |
| year         | å‡ºå» å¹´ä»½                                             |
| cyl          | æ°£ç¼¸æ•¸                                               |
| trans        | è‡ªï¼æ‰‹æ’                                             |
| drv          | f = front-wheel drive, r = rear wheel drive, 4 = 4wd |
| cty          | city miles per gallon åŸå¸‚é§•é§›æ²¹è€—                   |
| hwy          | highway miles per gallon é«˜é€Ÿå…¬è·¯é§•é§›æ²¹è€—            |
| fl           | æ±½æ²¹: ethanol E85, diesel, regular, premium, CNG     |
| class        | è»Šå‹                                                 |

## ç”¨åœ–è¡¨å›ç­”å•é¡Œ

- å¤§å¼•æ“çš„è»Šå­æ›´è€—æ²¹å—ï¼Ÿå¦‚æœæ˜¯çš„è©±ï¼Œé‚£æœ‰å¤šè€—æ²¹ï¼Ÿ
- å¼•æ“å¤§å°å’Œæ²¹è€—æ•ˆç‡ä¹‹é–“çš„é—œä¿‚ç‚ºä½•ï¼Ÿæ­£/è² ç›¸é—œï¼Ÿç·šæ€§/éç·šæ€§ï¼Ÿç›¸é—œç¨‹åº¦ï¼Ÿ

## å¦‚æœä½ çµ¦ä½ è€é—†çœ‹é€™ç¨®è¡¨æ ¼

<img src="img/mpg-table-1.png" style="height:auto; max-width:100%;">

## ä¸€å€‹ä¾‹å­å­¸æœƒç•«åœ–ï¼šmpg

å…ˆçœ‹å…©å€‹è®Šæ•¸ï¼š

1. displ - å¼•æ“æ’æ°£å…¬å‡
2. hwy - (æ²¹è€—æ•ˆç‡ï¼Œå“©/åŠ ä¾–)


## Scatterplots

```{r}
library(ggplot2)
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))
```

##

å¾åœ–è¡¨å¯æ­¸ç´å¹¾å€‹çµè«–ï¼š

1. å…©è®Šæ•¸ç‚ºé«˜åº¦è² ç›¸é—œ â”€â”€ å¤§å¼•æ“ => ä½æ•ˆç‡
2. æœ‰äº›è»Šæ˜¯é›¢ç¾¤å€¼

<img src="img/mpg-outlier.png" style="max-height:auto; max-width:50%;">

```{r, eval=FALSE, include=FALSE}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point() +
  geom_point(data = dplyr::filter(mpg, displ > 5, hwy > 20), colour = "red", size = 2.2)
```


## Exercise: ç”¨ `mpg` è³‡æ–™ç•«ä¸åŒçš„åœ–

çœ‹çœ‹ä¸åŒè®Šæ•¸ä¹‹é–“çš„ç›¸é—œ

- ç•«å‡º scatterplot: `hwy` vs `cyl`
- ç•«å‡º scatterplot: `class` vs `drv`

## Answer-1

```{r, message=FALSE}
## hwy vs cyl
ggplot(data = mpg) +
  geom_point(mapping = aes(x = hwy, y = cyl))
```

## Answer-2

```{r, message=FALSE}
## class vs drv
ggplot(data = mpg) +
  geom_point(mapping = aes(x = class, y = drv))
```

# Aesthetic Mapping

## Aesthetic Mapping

- åœ¨ **Grammar of Graphics** è£¡é¢æœ€é‡è¦çš„æ¦‚å¿µå°±æ˜¯ **<underline>Aesthetic Mapping</underline>**
- åœ¨ç•«åœ–å‰æˆ‘å€‘å…ˆä¾†ç·´ç¿’ç”¨çœ¼ç›ğŸ‘€çœ‹ **aethetics**

## Exercise: è§€å¯Ÿ Aesthetic Mapping

- æœ‰å“ªäº›è®Šæ•¸ variables
- åˆ†åˆ¥å°æ‡‰åˆ°å“ªå€‹ aethetic

## Aesthetics åŸºæœ¬é¡Œ 1

>- x = displ
>- y = hwy
>- color = class

```{r, echo=FALSE}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, color = class), size = 3)
```

## Aesthetic Mappings

åœ¨ x-y äºŒç¶­çš„ Scatterplot åŠ å…¥ç¬¬ä¸‰å€‹ aesthetic

- æŠŠ class å°æ‡‰åˆ°é»çš„**é¡è‰²**
- hint: `?geom_point`: æŸ¥è©¢æ”¯æ´çš„ aesthetics


## Aesthetic Mappings

- x = displ
- y = hwy
- color = class

```{r}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, color = class))
```


## Aesthetics åŸºæœ¬é¡Œ 2

>- x = displ
>- y = hwy
>- alpha (é€æ˜åº¦) = class

```{r, echo=FALSE}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, alpha = class), size = 3)
```


## Exercise

è©¦è©¦åœ¨ x-y äºŒç¶­çš„ Scatterplot åŠ å…¥ç¬¬ä¸‰å€‹ aesthetic

- æŠŠ class å°æ‡‰åˆ°é»çš„**alpha (é€æ˜åº¦) **
- hint: `?geom_point`: æŸ¥è©¢æ”¯æ´çš„ aesthetics

## Answer

```{r}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, alpha = class))
```


## Aesthetics åŸºæœ¬é¡Œ 3

>- x = displ
>- y = hwy
>- shape = class

```{r, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```


## Exercise

è©¦è©¦åœ¨ x-y äºŒç¶­çš„ Scatterplot åŠ å…¥ç¬¬ä¸‰å€‹ aesthetic

- æŠŠ class å°æ‡‰åˆ°é»çš„**å½¢ç‹€**

## Answer

```{r}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```


## Aesthetic Mappings

```{r, eval=FALSE}
ggplot(data = <DATA>) + # Data
  geom_<xxx>(
     mapping = aes(<MAPPINGS>), ##  <= Aesthetic mappings
     stat = <STAT>,
     position = <POSITION>
  ) +
  scale_<xxx>() + coord_<xxx>() + facet_<xxx>()
  theme_()
```

- `aes()` å¯ä»¥æ”¾åœ¨ï¼š
    - `ggplot()`è£¡é¢ -- **æœ‰**<underline>"è¨˜æ†¶æ•ˆæœ"</underline>(æˆç‚ºæ‰€æœ‰åœ–å±¤é è¨­å¸¶å…¥)
    - å¤–é¢ `+ aes()` -- **æœ‰**<underline>"è¨˜æ†¶æ•ˆæœ"</underline>(æˆç‚ºæ‰€æœ‰åœ–å±¤é è¨­å¸¶å…¥)
    - `geom_<xxx>()`è£¡é¢ -- **ç„¡**"è¨˜æ†¶æ•ˆæœ"(åªå°è©² geom æœ‰æ•ˆ)
- `geom_<xxx>(inherit.aes=FALSE)`: overrides the default aesthetics.



## Static Aesthetic

æœ‰æ™‚å€™ä½ å¯èƒ½åªæƒ³è¦æ‰‹å‹•è¨­å®šæŸå€‹<underline>å›ºå®š aesthetic</underline>ï¼Œé€™å€‹ä¾‹å­çš„è¨­å®šåªç‚ºäº†ç¾è§€ï¼Œ
ä¸¦ä¸æœƒå¸¶å‡ºå¤šé¤˜è³‡æ–™è¨Šæ¯ã€‚

- å°‡ aesthetic æ”¾åœ¨ aes() è£¡é¢: map aesthetic ä¸¦è‡ªå‹•å»ºç«‹ legend
- å°‡ aesthetic æ”¾åœ¨ aes() ä¹‹å¤–: æ‰‹å‹•è¨­å®šæŸå€‹å›ºå®š aesthetic

```{r}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy), color = "blue")
```



## Aesthetics: Perceptual Task {.flexbox .vcenter}

<img src="img/perceptual-task.png" style="max-height:520px; max-width:auto;">

<div class="footer">
- https://www.geography.wisc.edu/faculty/roth/publications/Roth_2015_EG.pdf
- http://www.iag-aig.org/attach/30dee1f85f7bd479367f1f933d48b701/V61N1_2FT.pdf
- http://www.infovis-wiki.net/index.php?title=Visual_Variables
</div>

## Aesthetics ä¸åªé€™äº›

å¦‚ä½•æŸ¥ï¼Ÿ

- `?geom_`: å„ **geom** æœ‰ä¸åŒæ”¯æ´çš„ aesthetics

<img src="img/aes-search.png" style="max-height:40%; max-width:auto;">

<!-- ## Visual Variable Accuracy {.flexbox .vcenter} -->

<!-- <a href="http://moritz.stefaner.eu/resources/datavis/osna/2013/"> -->
<!-- <img src="img/mackinlay1.jpg" style="height:480px; max-width:auto;"> -->
<!-- </a> -->

## Visual Variable Accuracy {.flexbox .vcenter}

<a href="https://joeparry.wordpress.com/2007/08/29/visual-variables/">
<img src="img/viz-variable-accuracy.png" style="max-height:480px; max-width:auto;">
</a>

<span class="red">***Bar Chart*** may be the most useful type!!</span>

<div  class="footer">
- [MacKinlay (1986)](http://www2.parc.com/istl/projects/uir/publications/items/UIR-1986-02-Mackinlay-TOG-Automating.pdf)
<div>


## HW: æ‰¾åœ–è§€å¯Ÿ Aesthetics

- ä¸Šç¶² [The Economist - Graphic detail](http://www.economist.com/blogs/graphicdetail) æ‰¾ 2 å¼µåœ–æˆ–è‡ªå·±æ‰‹ä¸Šæœ‰çš„åœ–ï¼Œæ‰¾å‡º variable å°æ‡‰çš„ aesthetic
- æ‰¾å‡ºæ˜¯å¦æœ‰å¤šé¤˜çš„å°æ‡‰ï¼ˆä¸€å€‹ variable å°å¤šå€‹ aestheticï¼‰
    - <span class="red2">âœ˜ åˆ‡å¿Œç•«è›‡æ·»è¶³</span>

## Junk Colors

<!-- <img src="img/junk-colors.png" style="max-height:auto; max-width:100%;"> -->

```{r, echo=FALSE, fig.width=10, fig.height=4}
p1 <- ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class, fill = class)) +
  guides(fill = FALSE) +
  ggtitle("Unnecessary Colors")
p2 <- ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class)) +
  ggtitle("Better")
cowplot::plot_grid(p1, p2)
```

## å¦‚ä½•åˆ¤æ–·å¥½çš„åœ–è¡¨

ä¸€é–‹å§‹æˆ‘å€‘åªè¦è‘—é‡åœ¨åœ–è¡¨çš„è³‡è¨Šæœ¬èº«:

1. <underline>å¢åŠ è³‡è¨Š</underline>
2. <underline>æ¸›å°‘é›œè¨Š</underline>

## Data-Ink Mazimazation

1. è³‡è¨Šåœ¨å“ªè£¡ï¼Ÿ
    - è·Ÿ<underline>è³‡æ–™æœ¬èº«</underline>ç›¸é—œçš„
    - è·Ÿ<underline>ç›®çš„</underline>ç›¸é—œçš„

2. é›œè¨Šåœ¨å“ªè£¡ï¼Ÿ
    - å…¶ä»–ä¸€åˆ‡ä¸ç›¸é—œçš„éƒ½å…ˆç•¶ä½œé›œè¨Š


## æ¶ˆå»ä¸éœ€è¦çš„å…ƒç´  {.flexbox .vcenter}

<img src="img/data-ink-ratio.png" style="max-height:auto; max-width:100%;">


## (é™„éŒ„) How Data-Ink Maximazation { .smaller }

1. å»é™¤ä¸å¿…è¦çš„éè³‡æ–™ç‰©ä»¶
    - å»æ‰ä¸å¿…è¦çš„èƒŒæ™¯è‰²å½©
    - å»æ‰ç„¡æ„ç¾©çš„è‰²å½©è®ŠåŒ–
    - æ·¡åŒ–åœ–è¡¨æ ¼ç·š
    - å»æ‰ä¸€åˆ‡ç«‹é«”æ•ˆæœ
2.  å¼±åŒ–å’Œçµ±ä¸€å‰©ä¸‹çš„éè³‡æ–™ç‰©ä»¶
    - ä½¿ç”¨æ·¡è‰²çš„ï¼šåº§æ¨™è»¸ã€æ ¼ç·šã€è¡¨æ ¼ç·šã€å¡«æ»¿è‰²
3. å»é™¤å¤šæ–¼è®Šæ•¸
    - ä¸€å€‹ `x-y æ–¹æ ¼` æœ€å¤šåªç•™ä¸‰å€‹è®Šæ•¸ï¼Œä¸€å€‹ç•«é¢å¤ªå¤šè®Šæ•¸æœƒå½±éŸ¿è³‡è¨Šå¸æ”¶
4. å¼·èª¿æœ€é‡è¦çš„è³‡æ–™é»
    - æ¨™è‰²


## ä¸­å ´ä¼‘æ¯ â™¨ï¸  {.flexbox .vcenter}

<a href="http://clterryart.tumblr.com/" target="_blank">
<img src="http://66.media.tumblr.com/282aaeea43d9a7ebd6f58e2270f1d7c5/tumblr_ockldgSWib1qzomoco1_540.gif" style="height:480px; max-width:100%;">
</a>

## There are two main plotting functions in `ggplot2`:

- `qplot()`: (quick plot) éœ€è¦å¿«é€Ÿç•«åœ–æ™‚æ‰ä½¿ç”¨ï¼Œç”¨æ³•å’Œ R çš„å…§å»ºç¹ªåœ–å‡½æ•¸ `plot()` å·®ä¸å¤š
- `ggplot()`: <underline>æ¨è–¦çš„ç¹ªåœ–æ–¹æ³•</underline>ï¼Œæ­é…ç¹ªåœ–æ­¥é©Ÿçš„å…¶ä»–å‡½æ•¸é€æ­¥å»ºæ§‹åœ–å±¤

## ggplot2 èµ·æ‰‹å¼

```{r, eval=FALSE}
ggplot(data = <DATA>) + # Data
  geom_<xxx>(
     mapping = aes(<MAPPINGS>),
     stat = <STAT>,
     position = <POSITION>
  ) + # Layers & Aesthetic mappings
  scale_<xxx>() + coord_<xxx>() + facet_<xxx>() # Position
  theme_()
```

## Data for Plot -- ETL

- æ¯ä¸€æ¬„ (column) éƒ½æ˜¯ä¸€å€‹<underline>(ç¹ªåœ–)è®Šæ•¸</underline>
- æ¯ä¸€åˆ— (row) éƒ½æ˜¯ä¸€ç­†<underline>è§€å¯Ÿå€¼</underline>
- Wide Format -> Long Format (`tidyr`)
    - [ä½ çš„è³‡æ–™æ˜¯å¯¬çš„é‚„æ˜¯é•·çš„ï¼Ÿ](https://connerchang.github.io/2016/08/12/long-wide-format/)
    

> è³‡æ–™å’Œåœ–è¡¨æ˜¯ä¸€é«”å…©é¢ï¼Œ<underline>å…ˆæœ‰è³‡æ–™æ‰æœ‰åœ–è¡¨</underline>

## ä»¥ `mpg` ç‚ºä¾‹

+ `mpg` å…±æœ‰ `r ncol(mpg)` å€‹è®Šæ•¸ `r nrow(mpg)` ç­†è³‡æ–™
+ é€™è£¡éœ€è¦çš„ç¹ªåœ–è®Šæ•¸ (aesthetic mapping)
    - x: `displ`
    - y: `hwy`


```{r, echo=FALSE}
print(mpg)
```

# Geoms

## Geoms

é€™å…©å¼µåœ–å·®åœ¨å“ªè£¡ï¼Ÿ

```{r, echo=FALSE, message=FALSE, fig.width=8, fig.asp=0.5}
library(cowplot)
theme_set(theme_light()) 
p1 <- ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))
p2 <- ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
cowplot::plot_grid(p1, p2)
```

## Geoms

- Geom æ±ºå®šåœ–è¡¨å‘ˆç¾çš„ã€Œ**å¹¾ä½•åœ–å½¢ç‰©ä»¶**ã€ï¼Œä¹Ÿå°±æ˜¯ä½ çœ¼ç›çœ‹åˆ°çš„è³‡æ–™å‘ˆç¾æ–¹å¼
- `geom_<xxx>()`

```{r}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))
```

```{r}
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
```


## Layers åœ–å±¤è§€å¿µ

è¦å‘ˆç¾å¤šå€‹å¹¾ä½•åœ–å½¢ç‰©ä»¶ (Geoms) æ™‚è¦æ€éº¼åšåˆ°å‘¢ï¼Ÿ

- ä¸€å€‹ `geom_<xxx>()` å°±æœƒåœ¨åœ–ä¸Šç•«ä¸€åœ–å±¤ (Layer)
- å¯<underline>ä¸€å±¤å±¤ç–ŠåŠ ä¸Šå»</underline>
- æ¯å€‹åœ–å±¤ç”šè‡³<underline>å¯ä»¥ç”¨ä¸åŒ data</underline>ï¼Œåœ¨ç•«é€²éšåœ–è¡¨æ™‚å¾ˆå¸¸ç”¨åˆ°
- ä½†è¦æ³¨æ„æ˜¯å¦æœ‰<underline>é è¨­çš„ aesthetic</underline> ä¸å°å¿ƒ mapping åˆ°è©²åœ–å±¤

## Layers åœ–å±¤è§€å¿µ

- å…©å±¤åœ–å±¤

```{r}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping= aes(x = displ, y = hwy))
```

## Geoms {.flexbox .vcenter}

<a href="http://www.datavizcatalogue.com/index.html" target="_blank">
<img src="img/chart-types.png" style="height:480px; max-width:auto;">
</a>

<div class="footer">
- http://flowingdata.com/2010/03/20/graphical-perception-learn-the-fundamentals-first/
</div>


## Geoms

- å› ç‚º Geoms çœŸçš„å¤ªå¤šäº†ï¼Œé€šå¸¸è¦ç”¨çš„æ™‚å€™å†å»æŸ¥
[cheatsheet](https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf)
- å¦‚åŒå‰é¢æ‰€è¿°ï¼Œä¸åŒ Geoms æœ‰ä¸åŒæ”¯æ´çš„ Aesthetics

<img src="img/aes-search.png" style="max-height:40%; max-width:auto;">

## (é™„éŒ„) Geoms -- Cheatsheet {.flexbox .vcenter}

<img src="img/visualization-geoms-1.png" style="max-height:auto; max-width:100%;">

## (é™„éŒ„) Geoms -- Cheatsheet {.flexbox .vcenter}

<img src="img/visualization-geoms-2.png" style="max-height:auto; max-width:100%;">

## (é™„éŒ„) Geoms -- Cheatsheet {.flexbox .vcenter}

<img src="img/visualization-geoms-3.png" style="max-height:auto; max-width:100%;">

## (é™„éŒ„) Geoms -- Cheatsheet {.flexbox .vcenter}

<img src="img/visualization-geoms-4.png" style="max-height:auto; max-width:100%;">

# Stats

## Bar Charts

- å„ç¨®è»Šå‹(`class`)çš„æ•¸é‡ï¼Ÿ
- `geom_bar()`

```{r}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class))
```

## åœ¨ç•«åœ–ä¹‹å‰

ä½ å¯èƒ½è¦å…ˆæƒ³åˆ°ç•«å‡ºé€™æ¨£çš„è¡¨æ ¼ï¼š

```{r, echo=FALSE}
mpg %>% 
  group_by(class) %>% 
  tally %>% 
  knitr::kable()
```

## è¡¨æ ¼èˆ‡è¦–è¦ºåŒ–çš„é—œè¯

- è¡¨æ ¼å°±æ˜¯ä¸€ç¨®è¦–è¦ºåŒ–çš„æ–¹å¼ï¼Œæœ‰æ™‚å€™ä¸€å¼µå¥½çš„è¡¨æ ¼è³‡è¨Šå°±å¾ˆæ¸…æ¥š
- ç•«åœ–åªæ˜¯å°‡é€™äº›è³‡è¨Šå†<underline>å¼·èª¿</underline>å‡ºä¾†

##  {.flexbox .vcenter}

<img src="img/mpg-table-viz.png" style="height:540px; max-width:100%;">


## Stats (Geom çš„ä¸€é«”å…©é¢)

- `stat_<xxx>()`
- æœ‰äº› Geom (ä¾‹å¦‚ scatterplot) ç•«çš„æ˜¯ <underline>**raw value**</underline> (stat_identity)
- æœ‰äº› Geom (ä¾‹å¦‚ barplot)æœƒ<underline>è¨ˆç®—æ–°çš„ stat</underline> (e.g., count) ä»¥ä¾›ç•«åœ–
- ä½¿ç”¨ `geom_<xxx>()` æ™‚ï¼Œè¦æ³¨æ„<underline>é è¨­</underline>çš„ stat æ˜¯ä»€éº¼

> æ¯å€‹æˆåŠŸçš„ **Geom** èƒŒå¾Œéƒ½æœ‰ä¸€å€‹å‰å¤§çš„ **Stat**


## stat = "identity" <underline>(ä¸è½‰æ›)</underline>

<img src="img/visualization-stat-point.png" style="height:520px; max-width:100%;">


## Stats?

å›é ­ä¾†çœ‹ Aesthetic Mapping

- x: `class`
- y: ?? **count** ä¸åœ¨åŸæœ¬çš„ `mpg` è³‡æ–™ä¸­

åˆ°åº• **count** æ˜¯<underline>æ€éº¼ç®—å‡ºä¾†çš„</underline>ï¼Ÿ

1. <s>åŸæœ¬å¯èƒ½åœ¨ Excel ç®—</s>
2. R å¹«ä½ ç®— `dplyr::summarise()`
3. ggplot2 `geom_bar` å¹«ä½ ç®—

> `?geom_bar` çš„é è¨­ `stat` æ˜¯ "count"

<img src="img/bar-stats.png" style="max-height:auto; max-width:100%;">

## stat = "count" æ˜¯æ€éº¼å¹«ä½ ç®—å‡ºä¾†çš„ {.flexbox .vcenter}

<img src="img/visualization-stat-bar-mpg.png" style="height:520px; max-width:100%;">

## å…ˆæ‰‹å‹•è™•ç† stats å†ç•«åœ–

(æœ‰æ™‚å€™é‡åˆ°è¤‡é›œçš„å•é¡Œå°±éœ€è¦æ‰‹å‹•å…ˆç®— Stats)

- Plot bar chart with `cut` in dataset `diamonds`

ç”¨ `dplyr::summarise()` ç®—å‡º count é€™å€‹è®Šæ•¸ï¼Œå†ç”¨ `ggplot2` ç•«åœ–

hint: `stat = "identity"`


```{r, collapse=TRUE, fig.width=6}
d <- mpg %>% 
  group_by(class) %>% 
  summarise(n = n())
d

ggplot(data = d) +
  geom_bar(mapping = aes(x = class, y = n),
           stat = "identity")
```

## Ecercise: æ‰‹å‹•å…ˆç®— Stats å†ç•«åœ–

- ç•«å‡ºå„ç¨®è»Šå‹(`class`)çš„å¹³å‡æ²¹è€— bar chart

hint:

- `dplyr::group_by()`
- `dplyr::summarise(mean(xxx))`,  
- `geom_bar(stat = "identity")`

```{r, echo=FALSE, collapse=TRUE, fig.width=6}
d <- mpg %>% 
  group_by(class) %>% 
  summarise(mean_hwy = mean(hwy))
d

ggplot(data = d) +
  geom_bar(mapping = aes(x = class, y = mean_hwy),
           stat = "identity")
```

## æ²’æœ‰æ’åºçš„ bar chart å¾ˆé›£çœ‹

- è¦æ€éº¼æ’åºï¼Ÿ
- `reorder(<è¦æ’åºçš„è®Šæ•¸>, <åƒç…§å¤§å°>)`  
  ï¼Šåªèƒ½ç”¨åœ¨æ‰‹å‹•ç®—çš„æ–¹å¼

```{r, collapse=TRUE, fig.width=6}
d <- mpg %>% 
  group_by(class) %>% 
  summarise(n = n())
d

ggplot(data = d) +
  geom_bar(mapping = aes(x = reorder(class, -n), y = n),
           stat = "identity")
```

## Try Bar Charts

- å¡«æ»¿é¡è‰² `fill`

(éŒ¯èª¤ç¤ºç¯„ï¼šä¸å»ºè­°åŒä¸€è®Šæ•¸ mapping å¤šå€‹ aes)

```{r}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class, fill = class))
```

## Geoms + Stats å¯¦ä¾‹

- **bar charts**, **histograms**: è¨ˆç®—æ¯ä¸€çµ„ bin è£¡é¢çš„æ•¸ç›®.

```{r}
ggplot(data = mpg, aes(x = class)) +
  geom_bar() +
  geom_text(stat = "count",
            aes(label = ..count.., y =..count..),
            vjust = "bottom")
```


## Geoms + Stats å¯¦ä¾‹

- å„ç¨®è»Šå‹çš„æ²¹è€—æ•ˆç‡
- **boxplots**: plot quartiles.

```{r}
ggplot(data = mpg) +
  geom_boxplot(mapping = aes(x = class, y = hwy))
```


## ä¸­å ´ä¼‘æ¯ â™¨ï¸  {.flexbox .vcenter}

<img src="img/take-a-break.gif" style="height:480px; max-width:100%;">

# å¦‚ä½•å­¸ç¿’è³‡æ–™è¦–è¦ºåŒ–

## å¾æŠ„åˆ¥äººçš„åœ–è¡¨å­¸èµ·

- åˆ¤æ–·åœ–è¡¨å¥½å£ä¹‹å¾Œï¼Œæˆ‘å€‘ä¹Ÿè¦å­¸æœƒåšå¥½åœ–è¡¨
- Google: "åœ–è¡¨åç¨± + R"
- å¦‚æœè¦ç”¨å¾—é †æ‰‹ï¼Œå¹³å¸¸å°±è¦<underline>å¤šçœ‹åˆ¥äººç•«çš„å¥½åœ–</underline>ï¼Œè¦ç”¨æ™‚æ‰çŸ¥é“å¾å“ªè£¡æ‰¾èµ·


## Google æ˜¯å­¸ç¿’ç•«åœ–çš„å¥½æœ‹å‹ { .centered }

<img src="img/google-ggplot2.png" style="max-height:auto; max-width:100%;">

-  åƒè¦‹é™„éŒ„ [è¦–è¦ºåŒ–è³‡æºæ•´ç†]

# Positions

## Positionsï¼šç•¶åœ–å½¢åœ¨ä½ç½®æ‰“æ¶æ™‚è¦æ€éº¼è¾¦ï¼Ÿ

- `?geom_bar`
- å †ç–Šï¼š`position = "stack"` (default)

```{r}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class, fill = manufacturer),
           position = "stack") +
  ggtitle('Position = "stack"')
```

## Positions

`position`: 

- "identity" åŒä¸€ä½ç½®ï¼ˆè¦†è“‹ä½å¾Œé¢åœ–å±¤ï¼‰
- "stack" å †ç–Š
- "dodge" ä½µæ’
- "fill" å †ç–Šä¸¦ scale è‡³ 100%
- "jitter" "æŠ–..." é»æœƒäº’ç›¸é–ƒé¿


ç•«å‡ºå„è»Šå» (`manufacturer`)åœ¨ä¸åŒè»Šå‹(`class`)çš„æ•¸é‡ç‚ºä½•ï¼Ÿ

### Position = "identity"

- åŒä¸€ä½ç½®ï¼ˆè¦†è“‹ä½å¾Œé¢åœ–å±¤ï¼‰

```{r}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class, fill = manufacturer),
           position = "identity", alpha = .4) +
  ggtitle('Position = "identity"')
```

### Position = "dodge"

- ä½µæ’

```{r}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class, fill = manufacturer),
           position = "dodge") +
  ggtitle('Position = "dodge"')
```


### Position = "fill"

- å †ç–Šä¸¦ scale è‡³ 100%

```{r}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class, fill = manufacturer),
           position = "fill") +
  ggtitle('Position = "fill"')
```

# Facets

## Too many variables!!!!

- çœ‹åˆ°å‰›æ‰çš„è»Šè»Šæ²¹è€—ğŸš—ï¼Œæ˜¯ä¸æ˜¯è¦ºå¾—é‚„æ˜¯å¾ˆé›£é€éåœ–è¡¨ç†è§£è³‡æ–™ï¼Ÿ
- å‰›æ‰ç•«çš„åœ–å› ç‚ºå¤šäº†ç¬¬3å€‹è®Šæ•¸ï¼Œæ‰€ä»¥æ›´é›£ç†è§£äº†

```{r, echo=FALSE, fig.asp=0.35, fig.width=10}
p1 <- ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class, fill = manufacturer),
           position = "stack") +
  ggtitle('Position = "stack"')
p2 <- ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class, fill = manufacturer),
           position = "dodge") +
  ggtitle('Position = "dodge"')
cowplot::plot_grid(p1, p2)
```

## Facets: Small-Multiples

- Facets æ˜¯å¾ˆé‡è¦çš„ä¸€å€‹å‘ˆç¾æ–¹å¼ï¼Œä¸€å®šè¦å­¸èµ·ä¾†
- ç‚ºä»€éº¼è¦ç”¨ Facetsï¼Ÿ
    1. ç•¶åŒä¸€å€‹åº§æ¨™å¹³é¢å¡å…¥å¤ªå¤šè®Šæ•¸ï¼Œæœƒé€ æˆå¤§è…¦ç„¡æ³•è² è·
    2. åˆ†æ‹†è³‡è¨Šï¼Œè®“å¤§è…¦å”åŠ©<underline>è…¦è£œ</underline>æ›´æœ‰æ•ˆç‡

<a href="https://en.wikipedia.org/wiki/Small_multiple">
<img src="img/horse-in-motion.jpg" style="height:100px; max-width:100%;">
</a>

> "Illustrations of postage-stamp size are indexed by category or a label, sequenced over time like the frames of a movie, or ordered by a quantitative variable not used in the single image itself." -- Edward Tufte

<div class="footer">
- http://www.juiceanalytics.com/writing/better-know-visualization-small-multiples
</div>


## Exercise

ç•«å‡ºå„è»Šå» (`manufacturer`)åœ¨ä¸åŒè»Šå‹(`class`)çš„æ•¸é‡ç‚ºä½•ï¼Ÿ

## å…ˆç”¨è¡¨æ ¼ä¾†æ€è€ƒ

- ä½ çš„ï¼ˆè¦–è¦ºåŒ–ï¼‰è¡¨æ ¼è¦æ€éº¼ç•«åˆ¥äººæ‰æœƒæ¸…æ¥šï¼Ÿ
- å†æ€è€ƒæŠŠè¡¨æ ¼æ”¾åˆ°åœ–è¡¨ä¸Šé¢ï¼Ÿ

ä¸‰å€‹è®Šæ•¸æ‡‰è©²æ€éº¼æ”¾ï¼š

- manufacturer
- class
- count

## 1. è€é—†æœƒå«ä½ å›å»é‡åšçš„è¡¨æ ¼

ä½†å»æ˜¯æˆ‘å€‘åœ¨ `ggplot2` éœ€è¦æ‹¿ä¾†ç•«åœ–çš„è¡¨æ ¼

```{r, echo=FALSE}
mpg %>% 
  group_by(manufacturer, class) %>% 
  tally() %>% 
  print(n=9999)
```

## 2. ç›´æ¥çœ‹å°±å¾ˆæ¸…æ¥šçš„è¡¨æ ¼

- Pivot æ¨ç´åˆ†æè¡¨

```{r, echo=FALSE}
mpg %>% 
  group_by(manufacturer, class) %>% 
  tally() %>% 
  spread(class, n, fill = 0) %>% 
  knitr::kable()
```

## 3. è®“è¦–è¦ºåŒ–å¢åŠ è³‡è¨Šçš„æ¸…æ™°åº¦

```{r, echo=FALSE, fig.width=10, fig.asp=1.4}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class)) +
  facet_wrap( ~ manufacturer, ncol = 2)
```

## Facets

- `facet_wrap()`

ç•«å‡ºå„è»Šå» (`manufacturer`)åœ¨ä¸åŒè»Šå‹(`class`)çš„æ•¸é‡ bar chart

- x: class
- y: count
- <s>fill</s> åˆªæ‰å¤šé¤˜çš„ mapping
- <underline>facet</underline>: manufacturer

```{r, fig.width=10, fig.asp=1.4}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x = class)) +
  facet_wrap( ~ manufacturer, ncol = 2)
```


## Facets

- åŸå‰‡ï¼š**ä¸€å€‹åº§æ¨™å¹³é¢(æ–¹æ ¼)æœ€å¥½<underline>ä¸è¦è¶…éä¸‰å€‹è®Šæ•¸</underline>**
- Don't [overplotting](http://www.perceptualedge.com/articles/visual_business_intelligence/over-plotting_in_graphs.pdf)
- æ‹†å‡ºé¡åˆ¥è®Šæ•¸ (nominal) æ”¾åœ¨å€‹åˆ¥çš„å°æ–¹æ ¼ (facets)

> ç•¶è®Šæ•¸å¾ˆå¤šæ™‚ Faceting å°±æ˜¯ä½ æœ€å¥½çš„æœ‹å‹ï¼


## HW: Faceting å¤šè®Šæ•¸

ç•«å‡ºå„è»Šå» (`manufacturer`)åœ¨ä¸åŒè»Šå‹(`class`)çš„  
å¹³å‡æ²¹è€—æ•ˆç‡(`hwy`) bar chart

hint: 

- `dplyr::group_by(xxx, xxx)`
- `dplyr::summarise(mean_hwy = mean(xxx))`  
- `geom_bar(stat = "identity")`
- `facet_wrap()`

```{r, echo=FALSE, collapse=TRUE, fig.width=10, fig.asp=1.3}
d <- mpg %>% 
  group_by(class, manufacturer) %>% 
  summarise(mean_hwy = mean(hwy))
d

ggplot(data = d) +
  geom_bar(mapping = aes(x = class, y = mean_hwy),
           stat = "identity") +
  facet_wrap( ~ manufacturer, ncol = 2)
```

# ä¾†è«‡è«‡å¦‚ä½•åˆ¤åˆ¥ä¸€å€‹å¥½çš„è³‡æ–™è¦–è¦ºåŒ–åœ–è¡¨

## Junk Charts & Trifecta Checkup {.flexbox .vcenter}

<img src="img/trifecta-checkup.png" style="height:auto; max-width:100%;">

## {.flexbox .vcenter}

<img src="img/bike-1.png" style="height:auto; max-width:100%;">

## {.flexbox .vcenter}

<img src="img/bike-2.png" style="height:auto; max-width:100%;">

## {.flexbox .vcenter}

<img src="img/bike-3.png" style="height:auto; max-width:100%;">

## {.flexbox .vcenter}

<img src="img/bike-4.png" style="height:auto; max-width:100%;">

# Labels

## Labels

åœ–è¡¨ä¸€å®šè¦æœ‰æ¨™é¡Œï¼Œåˆ¥äººæ‰çŸ¥é“ä½ è¦è¬›çš„æ•…äº‹æ˜¯ä»€éº¼

- `ggtitle()`, `xlab()`, `ylab()`
- çµ„åˆæŠ€ -- `labs()`: å„ç¨®æ¨™è¨»(axis labels, legend titles, plot title/subtitle and below-plot caption)

## Labels

### æ¨™é¡Œ

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +
  geom_smooth() + 
  ggtitle("Fuel efficiency vs. Engine size")
```

### æ¨™é¡Œ + åº§æ¨™è»¸

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +
  geom_smooth() + 
  ggtitle("Fuel efficiency vs. Engine size") +
  xlab("Engine displacement (L)") +
  ylab("Highway fuel efficiency (mpg)") 
```

### æ¨™é¡Œ + å‰¯æ¨™é¡Œ (Dev ç‰ˆæœ¬) + Color (legend title)

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +
  geom_smooth() + 
  labs(title = "Fuel efficiency vs. Engine size",
       subtitle = "Dataset: mpg",
       color = "Car Class")
```


## Theme

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +
  geom_smooth() +
  theme_bw()
```

## ggplot2 å…§å»º theme

Exercise: è©¦è©¦çœ‹ä¸åŒçš„ theme_*()

<img src="img/visualization-themes.png" style="height:520px; max-width:100%;">


## (é™„éŒ„) Theme ç›¸é—œå¥—ä»¶ { .columns-2 }

- [`ggthemes`](https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html) (æ¨è–¦)
- [`artyfarty`](https://github.com/Bart6114/artyfarty)
- [`ggthemr`](https://github.com/cttobin/ggthemr)


# å°çµ

## ggplot2 çš„ç¹ªåœ–æµç¨‹ (é™„éŒ„)

<img src="img/ggplot2-basic.png" style="max-height:400px; max-width:100%;">

## ggplot2 çš„ç¹ªåœ–æµç¨‹ (é™„éŒ„)

1. **Data** (noun/subject)
2. **Aesthetic mappings** (adjectives): x, y, color, size, ...
3. **Layers**: Geom (verb), Stat (adverb)
4. **Position** (preposition): Scales, Coord, Facet
5. **Theme**


## ä¸­å ´ä¼‘æ¯åƒåˆé¤ â™¨ï¸  {.flexbox .vcenter}

<a href="http://clterryart.tumblr.com/post/148345925537" target="_blank">
<img src="http://66.media.tumblr.com/7e5c7bae924645bfed484e480ae9e200/tumblr_oba7cqIJOL1qzomoco1_540.gif" style="height:480px; max-width:100%;">
</a>


## è¦–è¦ºåŒ–æµç¨‹ç¸½çµ

(éå¸¸é‡è¦ï¼)  (éå¸¸é‡è¦ï¼)  (éå¸¸é‡è¦ï¼)

<underline>***å¾çµæœï¼ˆç”¢å‡ºï¼‰å€’å›ä¾†æƒ³***</underline>

1. **Issue**: é€™å¼µåœ–è¡¨æƒ³è§£æ±ºçš„<underline>å•é¡Œæ˜¯ä»€éº¼</underline>ï¼Ÿ
2. **Geoms**: è¦<underline>ç•«ä»€éº¼æ¨£çš„åœ–</underline>ï¼Ÿ
    - bar chart, line chart, heat map, ...
3. **Variables**: éœ€è¦é‚£äº›è®Šæ•¸ï¼Ÿæˆ‘çš„<underline>è³‡æ–™</underline>æœ‰é€™äº›è®Šæ•¸å—ï¼Ÿ
    - variables needed from the data
4. **Aesthetic Mapping**
    - x: <variable 1>
    - y: <variable 2>
    - ...


## HW: ç•«è‡ªå·±çš„åœ–

- æ‰¾å‡ºä¸€å¼µå¹³å¸¸æœƒç•«çš„åœ–è¡¨ï¼Œä»¥åŠå…¶è³‡æ–™ï¼Œå¡«å…¥ä¸Šé¢æ ¼å¼
- è©¦è‘—ç”¨ `ggplot2` ç•«å‡ºä¾†ï½
    - è³‡æ–™åŒ¯å…¥
    - è³‡æ–™å‰è™•ç†
    - ç•«åœ–
    - åŒ¯å‡ºæˆ png


# R çš„ç¹ªåœ–æ¥­éšœæ¶ˆé™¤<br/>å¾ˆå°‘äººè§£ï¼Œå»å¾ˆé—œéµçš„æŠ€å·§

## æ¥­éšœ 1: ä¸­æ–‡å­—å‹

### Mac

ggplot2: 

```{r, eval=FALSE}
# åœ¨æœ€å¾ŒåŠ ä¸Š
theme(text = element_text(family = "STHeiti"))

# è‹¥æœ‰ç”¨åˆ° geom_text å‰‡è¦åœ¨è£¡é¢åŠ  family = "STHeiti"
geom_text(family = "STHeiti")
```

è¼¸å‡º:

```{r, eval=FALSE}
ggsave(device = "png", type = "cairo")`
```

### Linux

åŸºæœ¬ä¸Šæ²’å•é¡Œ

### Windows

åŸºæœ¬ä¸Šæ²’å•é¡Œ


## æ¥­éšœ 2: å¦‚ä½•åŒ¯å…¥è³‡æ–™

<img src="img/import-data-1.png" style="max-height:auto; max-width:100%;">

<img src="img/import-data-2.png" style="max-height:auto; max-width:100%;">

<img src="img/import-data-3.png" style="max-height:auto; max-width:100%;">


## æ¥­éšœ 3: Export Plots å¦‚ä½•åŒ¯å‡ºåœ–è¡¨

```{r, eval=FALSE}
p <- ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +
  geom_smooth() +
  theme_bw()

## ggplot åŒ¯å‡ºå°ˆç”¨
ggsave(p,
       filename = "my_plot.png",
       device = "png", h = 2, w = 3, type = "cairo")
# system(paste("open my_plot.png"))
```

æˆ–ç”¨

```{r, eval=FALSE}
png(filename = "my_plot.png",
    h = 2, w = 3, type = "cairo")  # é–‹å•Ÿç¹ªåœ– device (é€™è£¡ç”¨çš„æ˜¯ png)
plot(p)    # é–‹å§‹ç•«åœ–
dev.off()  # é—œé–‰ç¹ªåœ– device
```

## Export Plots åŒ¯å‡ºåœ–è¡¨

<img src="img/export-plot-1.png" style="max-height:auto; max-width:100%;">

<img src="img/export-plot-2.png" style="max-height:auto; max-width:100%;">

<img src="img/export-plot-3.png" style="max-height:auto; max-width:100%;">


# ggplot2 é€²éšæ“ä½œèˆ‡å»¶ä¼¸æ‡‰ç”¨

## Scales

`scale_<aes>_<å±¬æ€§>()`

- æœ‰æ™‚å€™å„ Aes è‡ªå‹•ç”¢ç”Ÿçš„ Scale çœ‹èµ·ä¾†å¾ˆç³Ÿï¼ˆå€é–“ä¸å°ã€å–®ä½ä¸å°ã€é¡è‰²ä¸å°, ...ï¼‰
- é€™æ™‚éœ€è¦<underline>èª¿æ•´ Aes çš„ Scale </underline>

| \<aes\>  | Description                          |
|----------|--------------------------------------|
| x        | x position and coordinate            |
| y        | y position and coordinate            |
| colour   | Color of lines and points            |
| fill     | Color of area fills (e.g. bar graph) |
| linetype | Solid/dashed/dotted lines            |
| shape    | Shape of points                      |
| size     | Size of points                       |
| alpha    | Opacity/transparency                 |

<p/>

| \<å±¬æ€§\>   | Description                                                           |
|------------|-----------------------------------------------------------------------|
| hue        | Equally-spaced colors from the color wheel                            |
| manual     | Manually-specified values (e.g., colors, point shapes, line types)    |
| gradient   | Color gradient                                                        |
| grey       | Shades of grey                                                        |
| discrete   | Discrete values (e.g., colors, point shapes, line types, point sizes) |
| continuous | Continuous values (e.g., alpha, colors, point sizes)                  |

## Scales -- æ•¸å€¼å‹åº§æ¨™

`scale_*_continuouts()`

- breaks åˆ»åº¦ (**tick-breaks**)
    - breaks: åˆ»åº¦å‘é‡
    - minor_breaks å‰¯æ ¼ç·š
- labels æ¨™ç±¤æ–‡å­—
    - A character vector giving labels (<underline>must be same length as **breaks**</underline>)
    - A function that takes the breaks as input and returns labels as output  
      `scales` å¥—ä»¶ (åƒåˆ†ä½`comma()`, éŒ¢è™Ÿ`dollar()`, å–®ä½`unit_format`, ...)
- limits æœ€å¤§æœ€å°å€¼
    - `c(æœ€å°å€¼, æœ€å¤§å€¼)`. (Use `NA` to refer to the existing minimum or maximum.)

## Scales -- æ•¸å€¼å‹åº§æ¨™

```{r, eval=FALSE}
library(ggplot2movies) # IMDB data
movies
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2movies) # IMDB data
DT::datatable(movies[sample(nrow(movies), 30),])
```


## Scales -- æ•¸å€¼å‹åº§æ¨™

```{r, echo=FALSE, fig.width=9, fig.height=12}
library(ggplot2movies) # IMDB data
d <- movies %>% filter(votes > 1000) # ç¯©é¸æŠ•ç¥¨æ•¸ 1,000 ä»¥ä¸Šçš„é›»å½±
m <- ggplot(d, aes(rating, votes)) +
  geom_point(na.rm = TRUE) 
thm <- theme(plot.title = element_text(color='blue'))

m1 = m + ggtitle("(Original)") + thm
#  * change the axis labels
m2 = m + scale_y_continuous("number of votes") +
  ggtitle('scale_y_continuous("number of votes")') + thm
#  * åƒåˆ†é€—è™Ÿ
m3 = m + scale_y_continuous(labels = scales::comma) +
  ggtitle('y: labels = scales::comma') + thm
#  * modify the tick-breaks
m4 = m + scale_x_continuous(breaks = c(0:10)) +
  ggtitle('x: breaks = c(0:10)') + thm
#  * manually label the ticks
m5 = m + 
  scale_x_continuous(breaks = c(2,5,8), 
                     labels = c("2 (horrible)", "5 (ok)", "8 (awesome)")) +
  ggtitle('x: breaks = c(2,5,8)\nlabels = c("2 (horrible)", "5 (ok)", "8 (awesome)"))') + thm
#  * modify the axis limits
m6 = m + scale_y_continuous(limits = c(0, 5000)) +
  scale_x_continuous(limits = c(7, 8)) +
  ggtitle('x: limits = c(7, 8)\ny: limits = c(0, 5000)') + thm
p <- cowplot::plot_grid(m1, m2, m3, m4, m5, m6, ncol = 2)
plot(p)
```

## Scales -- æ•¸å€¼å‹åº§æ¨™

```{r, eval=FALSE}
library(ggplot2movies) # IMDB data
d <- movies %>% filter(votes > 1000) # ç¯©é¸æŠ•ç¥¨æ•¸ 1,000 ä»¥ä¸Šçš„é›»å½±
m <- ggplot(d, aes(rating, votes)) +
  geom_point(na.rm = TRUE)
m

#  * change the axis labels
m + scale_y_continuous("number of votes")

#  * åƒåˆ†é€—è™Ÿ
m + scale_y_continuous(labels = scales::comma)

#  * modify the tick-breaks
m + scale_x_continuous(breaks = c(0:10))

#  * manually label the ticks
m + scale_x_continuous(breaks = c(2,5,8), 
                       labels = c("2 (horrible)", "5 (ok)", "8 (awesome)"))

#  * modify the axis limits
m + scale_y_continuous(limits = c(0, 5000)) +
    scale_x_continuous(limits = c(7, 8))
```

## Scales -- æ—¥æœŸåº§æ¨™

```{r, eval=FALSE}
scale_x_date(date_breaks = <date breaks>, 
             date_labels = "'%y-%m")
```

- **date_breaks**: æ™‚é–“é–“éš” `"2 weeks"`, `"10 years"`, ...
- **date_labels**: æ™‚é–“æ ¼å¼`?strptime`ã€‚å¯æŸ¥è©¢ date_labelsçš„æ™‚é–“æ ¼å¼æ€éº¼å¯«

## Scales -- æ—¥æœŸåº§æ¨™

```{r, collapse=TRUE}
# ç¾åœ‹ç¸½çµ±è³‡æ–™
presidential

d <- presidential %>%
  mutate(id = 33 + row_number())  # id: å±†æ•¸

ggplot(d, aes(x = start, y = id)) +
  geom_point() +
  geom_segment(aes(xend = end, yend = id)) +
  geom_text(aes(label = name), hjust = 0,  vjust = 0, nudge_y = 0.2) +
  scale_x_date(NULL, breaks = presidential$start, date_labels = "'%y")
```


## Scales -- é›¢æ•£å‹åº§æ¨™ (å¾ˆå°‘ç”¨åˆ°)

`scale_*_discrete()`

```{r, collapse=TRUE}
p <- ggplot(diamonds, aes(cut)) + geom_bar()

# * å®¢åˆ¶åŒ–æ¨™ç±¤
p + scale_x_discrete("Cut", 
                     labels = c("Fair" = "F",
                                "Good" = "G",
                                "Very Good" = "VG",
                                "Perfect" = "P",
                                "Ideal" = "I"))

# * Use limits to adjust the which levels (and in what order)
# are displayed
p + scale_x_discrete(limits=c("Fair","Ideal"))
# ä¹Ÿå¯ä»¥ç›´æ¥ç”¨åº§æ¨™ä¾†èª¿
# p + xlim("Fair","Ideal", "Good")
# p + ylim("I1", "IF")
```

## ä¸­å ´ä¼‘æ¯ â™¨ï¸  {.flexbox .vcenter}

<a href="http://clterryart.tumblr.com/" target="_blank">
<img src="http://66.media.tumblr.com/282aaeea43d9a7ebd6f58e2270f1d7c5/tumblr_ockldgSWib1qzomoco1_540.gif" style="height:480px; max-width:100%;">
</a>


# Colors

## Preattentive Processing

é¡è‰²æ˜¯å¾ˆå¼·å¤§çš„å·¥å…·

- ä½ç²¾æº–æ€§ï¼ˆè¼ƒé›£é€éé¡è‰²åˆ¤æ–·æ•¸å€¼ï¼‰
- ä½†æ˜¯å¾ˆèƒ½<underline>å¸å¼•æ³¨æ„åŠ›</underline>ï¼

<a href="http://lenagroeger.s3.amazonaws.com/WaldoWeeThings/weethings_sourcepost.html">
<img src="img/preattentivewaldo.jpg" style="height:320px; max-width:100%;">
</a>

## Feature Hierarchy

<a href="http://lenagroeger.s3.amazonaws.com/WaldoWeeThings/weethings_sourcepost.html">
<img src="img/color-over-shape.png" style="height:320px; max-width:100%;">
</a>

> Elements within an assortment of objects are perceptually grouped together if they are similar to each other. -- [Gestalt's law of similarity](https://en.wikipedia.org/wiki/Gestalt_psychology)

<div class="footer">
- http://ux.stackexchange.com/questions/48447/whats-the-purpose-of-the-bottom-bar-in-popups-modal-windows
- http://www.infovis-wiki.net/index.php/Preattentive_processing
</div>

## èª¿é¡è‰²è¦æ³¨æ„çš„åœ°æ–¹

- æ²’äº‹åˆ¥äº‚èª¿é¡è‰²ï¼Œæœ‰éœ€è¦å†æ”¹
- è¦èª¿é¡è‰²çš„è©±ç­‰åˆ°<underline>æœ€å¾Œå†å‹•</underline>

## Scale Color and Fill

é›¢æ•£å‹è³‡æ–™ vs é€£çºŒå‹è³‡æ–™

![](img/scale_color_fill.png)


## Scale Color and Fill -- é›¢æ•£å‹

[RColorBrewer](http://colorbrewer2.org/)æ˜¯éå¸¸å°ˆæ¥­çš„(åœ°åœ–è³‡æ–™)è‰²ç¥¨å·¥å…·

[Example: RColorBrewler æ¼”ç·´](example/RColorBrewer.html)

```{r, fig.height=8}
library(RColorBrewer)
display.brewer.all()
```


## Scale Color and Fill -- Manual (æ‰‹å‹•å¡«è‰²)

```{r}
d <- presidential %>%
  mutate(id = 33 + row_number())

ggplot(d, aes(start, id, colour = party)) +
  geom_point() +
  geom_segment(aes(xend = end, yend = id)) +
  geom_text(aes(label = name), hjust = 0,  vjust = 0, nudge_y = 0.2) +
  scale_x_date(NULL, breaks = presidential$start, date_labels = "'%y") +
  scale_colour_manual(values = c(Republican = "Red", Democratic = "Blue"))
```

# Text Labeling

## Text Labeling

Exercise: åœ¨å‰›æ‰ç•«çš„ dot plot æ¨™è¨»å„"è»Šå‹"æ²¹è€—æ•ˆç‡æœ€ä½³çš„è»Š

```{r, eval=FALSE}
library(dplyr)
library(ggplot2)

mpg %>%
  group_by(class) %>%
  mutate(rank = row_number(desc(hwy))) %>% 
  arrange(class, rank, hwy) %>% 
  View
```

```{r}
## å„"è»Šå‹"æ²¹è€—æ•ˆç‡æœ€ä½³çš„è»Š
best_in_class <- mpg %>%
  group_by(class) %>%
  filter(row_number(desc(hwy)) == 1)

ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point(aes(colour = class)) +
  geom_text(aes(label = model), data = best_in_class)
```

## Text Labeling

- `ggrepel` - è‡ªå‹•è¨ˆç®—æ¨™è¨»æ–‡å­—çš„ä½ç½®

Sometimes labeling on dots is not an easy work when plottng, especially when you have lots of dots in you plotting area.

- use `geom_text_repel()` instead of `geom_text()`

```{r, echo=FALSE, fig.asp=0.4, fig.width=8}
library(dplyr)
library(ggplot2)
library(ggrepel)
library(cowplot)

best_in_class <- mpg %>%
  group_by(class) %>%
  filter(row_number(desc(hwy)) == 1)

p <- ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point(aes(colour = class))

p1 <- p +
  geom_text(aes(label = model),
            data = best_in_class,
            color = "#666666") +
  theme_classic()
p2 <- p +
  geom_text_repel(aes(label = model),
            data = best_in_class,
            color = "#666666") +
  theme_classic()
cowplot::plot_grid(p1, p2)
```

<!-- ## footnote -->

<!-- - `gridExtra` -->

<!-- ```{r} -->
<!-- library(gridExtra) -->
<!-- ``` -->

# å‹•æ…‹åœ–è¡¨

## ggplot to Plotly ç°¡å–®è£½ä½œå‹•æ…‹åœ–è¡¨

[Plotly](https://plot.ly/ggplot2/)

åªéœ€è¦ä¸€è¡Œç¥å¥‡çš„æŒ‡ä»¤ï¼

```{r, eval=FALSE}
library(plotly)
p <- ggplot() + ...
ggplotly(p)  # ç¥å¥‡çš„æŒ‡ä»¤
```

Excercise: è«‹æŠŠä¸‹é¢çš„åœ–è®Šæˆå‹•æ…‹åœ–è¡¨

```{r}
p <- ggplot(mpg) +
  geom_point(aes(x = displ, y = hwy, color = class))
```


```{r, echo=FALSE}
library(plotly)
ggplotly(p)
```

# å ±å‘Šè£½ä½œ<br/>with R Markdown

## R Markdown

**çµ‚æ¥µæ‡‰ç”¨**ï¼š<underline>ä¸€æ¢é¾</underline>ç”¨ R åšå ±å‘Š

![](img/prettydoc_cayman.png)

## R Markdown

- Markdown èªæ³•

```
æ‰€æœ‰æ›æ®µéƒ½å¿…é ˆç©ºä¸€è¡Œï¼ï¼ï¼
æ‰€æœ‰æ›æ®µéƒ½å¿…é ˆç©ºä¸€è¡Œï¼ï¼ï¼
æ‰€æœ‰æ›æ®µéƒ½å¿…é ˆç©ºä¸€è¡Œï¼ï¼ï¼

ä¸æƒ³æ›æ®µä½†æƒ³å¼·åˆ¶æ›è¡Œåœ¨å¾Œé¢ç”¨å…©å€‹ç©ºç™½__

# å¤§æ¨™
## ä¸­æ¨™
### å°æ¨™

- Bullet Point
- Bullet Point

1. æœ‰åº
2. æœ‰åº

[é€£çµ](url)
![åœ–ç‰‡èªªæ˜](img)

*æ–œé«”*
**ç²—é«”**
***æ–œç²—é«”***
```

## R Markdown

ä¸€èµ·å‹•æ‰‹ä¾†åšä¸€ä»½å ±å‘Š

[Example: è³‡æ–™æ–°è--å°ç£å¯¦è³ªè–ªè³‡çœŸçš„å€’é€€ 20 å¹´å—ï¼Ÿ](example/salary.html)

[![](https://scontent-tpe1-1.xx.fbcdn.net/v/t1.0-9/12993628_1734303790181913_6620833205211657698_n.png?oh=a359a151e08d1db77c2af50094e62035&oe=583BDE45)](https://www.facebook.com/imDataMan/photos/a.1703493919929567.1073741828.1703467299932229/1734303790181913/?type=3&theater)

## ä¸­å ´ä¼‘æ¯ â™¨ï¸  {.flexbox .vcenter}

<a href="http://clterryart.tumblr.com/" target="_blank">
<img src="http://66.media.tumblr.com/282aaeea43d9a7ebd6f58e2270f1d7c5/tumblr_ockldgSWib1qzomoco1_540.gif" style="height:480px; max-width:100%;">
</a>


## R Markdown Template

æœ‰å¾ˆå¤šåˆ¥äººé–‹ç™¼å¥½çš„æ¼‚äº®å¥—ç‰ˆå¯ä»¥ç›´æ¥æ‹¿ä¾†ç”¨ï¼Œ
ä»Šå¤©è¦æ•™çš„æ˜¯ `prettydoc` é€™å€‹å¥—ä»¶

1. Install prettydoc. `install.packages("prettydoc")`
2. New File > R Markdown > From Template
3. Choose "Light Weight and Pretty Document (HTML) {prettydoc}"

## è¦–è¦ºåŒ–æ‡‰ç”¨

- [Example: æ¨‚é€è³‡æ–™](example/lottery.html)

## Map ç•«åœ°åœ– { .smaller }

[Example: åœ°åœ–è¦–è¦ºåŒ– â€“ Leaflet](example/map_leaflet.html)

<a href="http://xkcd.com/1138/">
<img src="img/xkcd-heatmap.png" style="height:480px; max-width:100%;">
</a>

[Data Man](https://www.facebook.com/imDataMan/photos/a.1703493919929567.1073741828.1703467299932229/1744422419170050/?type=3)ã€ç•«åœ°åœ–æ™‚æœ€éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼šäººå£å¯†åº¦å¯èƒ½æ¬ºé¨™çœ¼ç›ã€‘

åœ¨ç•«åœ°åœ–çš„æ™‚å€™ï¼Œæœ€éœ€è¦è¨˜å¾—çš„ä¸€ä»¶äº‹æ˜¯ï¼šäººå£å¯†åº¦é«˜çš„åœ°æ–¹ï¼Œç™¼ç”ŸæŸç¨®äº‹ä»¶çš„æ¬¡æ•¸æ‡‰è©²ä¹Ÿæœƒé«˜ã€‚æ¯”æ–¹èªªï¼Œæˆ‘å€‘è¦ç•«å…¨å°ç£çš„å¯µç‰©èµ°å¤±åœ°åœ–ï¼Œå› ç‚ºå°åŒ—å¸‚äººå£å¯†åº¦é«˜ï¼Œå› æ­¤æ¯å–®ä½é¢ç©å¯µç‰©éš»æ•¸ï¼Œç†ç•¶æ¯”è‹—æ —ç¸£ä¾†å¾—é«˜ï¼ˆå…ˆä¸è€ƒæ…®å°åŒ—å¸‚å’Œè‹—æ —ç¸£æ°‘èª°æ¯”è¼ƒæ„›é¤Šå¯µç‰©ï¼‰ï¼Œå› æ­¤å¯µç‰©èµ°å¤±çš„éš»æ•¸æ‡‰è©²ä¹Ÿæœƒæ¯”è¼ƒå¤šã€‚

å¦‚æœæŠŠå¯µç‰©èµ°å¤±å¯†åº¦åŒ–æˆåœ°åœ–ï¼Œå°±æœƒå‡ºç¾å°åŒ—å¸‚çš„é¡è‰²å¾ˆæ·±ï¼Œè‹—æ —é¡è‰²è¼ƒæ·ºçš„æƒ…æ³ã€‚ä½†é€™ä¸¦ä¸ä»£è¡¨å°åŒ—å¸‚çš„å¯µç‰©æ¯”è¼ƒå®¹æ˜“èµ°å¤±ï¼Œåªæ˜¯åæ˜ å…©åœ°çš„äººå£å¯†åº¦ä¸åŒã€‚ä¸éï¼Œè¼ƒæ²’ç¶“é©—çš„ç¹ªåœ–è€…å’Œè®€è€…ï¼Œå¯èƒ½å°±æœƒå¾é€™å¼µåœ°åœ–å¾—å‡ºã€Œå°åŒ—å¸‚å¯µç‰©æ¯”è¼ƒå®¹æ˜“èµ°å¤±ã€çš„çµè«–ï¼ŒçŠ¯ä¸‹æˆ‘å€‘ä»Šå¤©åˆ†äº«çš„æ¼«ç•«ä¸­çš„äººä¸€æ¨£çš„éŒ¯èª¤ã€‚

å› æ­¤ï¼Œåœ¨ç¹ªè£½å¯†åº¦åœ°åœ–çš„æ™‚å€™ï¼Œä¸€å®šè¦å…ˆæƒ³åˆ°ï¼šæˆ‘å€‘åˆ©ç”¨çš„æ•¸æ“šè·Ÿäººå£å¯†åº¦æœ‰ç„¡ç›¸é—œæ€§ï¼Œæœ‰çš„è©±ï¼Œè¦æ€éº¼æ’é™¤äººå£å¯†åº¦çš„å½±éŸ¿ï¼Œæ‰èƒ½å¾åœ°åœ–ä¸­æ‰¾å‡ºæ•¸æ“šçœŸæ­£åŸ‹è—çš„æ•…äº‹ã€‚


# Reference

## Resources è¦–è¦ºåŒ–è³‡æºæ•´ç† { .smaller .columns-2 }

#### Data Cleansing (ETL)

- dplyr
- tidyr
- broom

#### ggplot2 Cookbook and Documentation

- [ggplot2 å®˜æ–¹ä½¿ç”¨æ‰‹å†Š](http://docs.ggplot2.org/current/): å®Œæ•´ç¯„ä¾‹ç´°ç¯€
- [Cookbook for R - Graphs](http://www.cookbook-r.com/Graphs/): æ­¤ç«™å…¶ä»–å­¸ç¿’è³‡æºä¹Ÿå¾ˆæ¨è–¦

#### Color Palettes

- [viridis](https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html)
- [artyfarty](https://github.com/Bart6114/artyfarty)
- [RColorBrewer](http://bxhorn.com/rcolorbrewer-palettes/)
- [ColorBrewer by PennState University](http://colorbrewer2.org/): Web tool for guidance in choosing choropleth map color schemes, based on the reasearch of Dr. Cynthia Brewer.

#### ggplot2 å»¶ä¼¸å¥—ä»¶

- [cowplot](https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html): çµ„åˆåœ–è¡¨
- [ggrepel](https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html): labeling ggplot
- [directlabels](http://directlabels.r-forge.r-project.org/docs/): labeling ggplot (has few bugs)
- [ggforce](https://github.com/thomasp85/ggforce): Accelarating ggplot2
- [ggfortify](https://github.com/sinhrks/ggfortify): Plot models of different packages

#### ggplot2 å»¶ä¼¸å¥—ä»¶æ•´ç†

- [ggplot2 Extensions & Gallery](https://www.ggplot2-exts.org/)

#### Cheatsheet

- [RStudio - ggplot2 Cheatsheet](https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf)


#### Other Viz Packages

- [sjPlot](http://www.strengejacke.de/sjPlot/): å¿«é€Ÿç¹ªè£½çµ±è¨ˆæ¨¡å‹å’Œè¡¨æ ¼ (html output)
- [sjmisc](https://github.com/sjPlot/sjmisc): Utility and recode functions for R and sjPlot. è™•ç†å•å· variable, label, spss file, ...
- [dygraphs](http://rstudio.github.io/dygraphs/): (RStudio) å‹•æ…‹ç¹ªè£½ time-series data
- [leaflet](https://rstudio.github.io/leaflet/): [Leaflet](http://leafletjs.com/) åœ°åœ–
- [ggvis](http://ggvis.rstudio.com/): (hadley) å‹•æ…‹åœ–è¡¨ï¼Œå¯æ­é… Shinyï¼Œå°šæœªæœ‰å®Œæ•´æ‡‰ç”¨é«”ç³»
- [rCharts](https://github.com/ramnathv/rCharts): (åœæ­¢é–‹ç™¼å¾ˆä¹…) å‹•æ…‹åœ–è¡¨

#### R Plot Galleries

- [R Graph Catalog - Creating More Effective Graphs](http://shiny.stat.ubc.ca/r-graph-catalog/): æœ‰æ•ˆåœ–è¡¨çš„æœ€ç°¡ç¯„ä¾‹é›†
- [R å‹•æ…‹åœ–è¡¨å¥—ä»¶é›† - htmlwidgets](http://gallery.htmlwidgets.org/)
- [RStudio - Quick list of useful R packages](https://support.rstudio.com/hc/en-us/articles/201057987-Quick-list-of-useful-R-packages)
- [THE R GRAPH GALLERY](http://www.r-graph-gallery.com/)
- [R graph gallery](http://rgraphgallery.blogspot.tw/)

#### Other Plot Galleries

- [The Data Visualisation Catalogue](http://www.datavizcatalogue.com/index.html): å„ç¨®åœ–è¡¨é¡å‹ç¯„ä¾‹
- [The Economist - Graphic detail](http://www.economist.com/blogs/graphicdetail): çœ‹ç¶“æ¿Ÿå­¸äººå¦‚ä½•ç”¨åœ–è¡¨èªªæ•…äº‹

#### è¦–è¦ºåŒ–å¿ƒæ³•

- [JunkCharts](http://junkcharts.typepad.com/)
- [Stephen Few - Perceptual Edge](http://www.perceptualedge.com/examples.php)
- [è³‡æ–™è¦–è¦ºåŒ–](http://blog.infographics.tw/category/%E5%BF%83%E6%B3%95/)


# æœ€å¾Œ

## ä½œæ¥­

- æ‰¾åœ–è§€å¯Ÿ Aesthetics
- å…ˆæ‰‹å‹•è™•ç† stats å†ç•«åœ–
- Faceting å¤šè®Šæ•¸
- ç•«è‡ªå·±çš„åœ–
- ç”¨ Rmd åšè‡ªå·±çš„å ±å‘Š

### [èª²å¾Œå•å·](https://goo.gl/forms/7Za8q70lsG54JO7z1)

